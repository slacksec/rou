<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Helloween!! ‚Äî üç¨ Clicker</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Creepster&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#000;--bg2:#0b0b0f;--fg:#ffa500;--fg2:#ffcf7a;--accent:#b30000;--card:#111319;--muted:#a2a2a2;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background: radial-gradient(1200px 700px at 50% -10%, #13131a 0%, var(--bg) 55%),
                                   radial-gradient(1200px 700px at 50% 110%, #101018 0%, var(--bg2) 55%);
      color:var(--fg); font-family:'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      display:flex; flex-direction:column; min-height:100vh;
    }
    header{
      position:sticky; top:0; z-index:20;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 18px; background:linear-gradient(#0d0d12cc,#0d0d12cc);
      border-bottom:1px solid #1f1f28; backdrop-filter:saturate(1.4) blur(6px);
    }
    .title{font-family:'Creepster', cursive; font-size: clamp(32px, 6vw, 58px); letter-spacing:1px;
      text-shadow:0 0 10px #ff6a00, 0 0 22px #7a0000}
    .statbar{display:flex; align-items:center; gap:14px; flex-wrap:wrap}
    .chip{display:flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px;
      background:#1a1b22; border:1px solid #262735; color:var(--fg2); font-weight:700}
    .chip small{color:var(--muted); font-weight:600}

    main{flex:1; display:grid; grid-template-columns:1fr 360px; gap:18px; padding:18px; max-width:1200px; width:100%; margin:0 auto}
    @media (max-width: 900px){ main{grid-template-columns:1fr} }

    /* Click zone */
    .play{
      position:relative; display:grid; place-items:center; border-radius:20px; background:linear-gradient(180deg,#0f0f14,#0b0b10);
      border:1px solid #1d1e28; min-height:520px; overflow:hidden;
    }
    .pumpkinBtn{
      font-size: clamp(64px, 14vw, 140px); line-height:1; cursor:pointer; user-select:none; border:none; background:transparent; 
      filter: drop-shadow(0 6px 20px rgba(255,140,0,.35)); transition: transform .06s ease; will-change:transform;
    }
    .pumpkinBtn:active{ transform: scale(.96) rotate(-2deg) }
    .click-plus{ position:absolute; pointer-events:none; font-weight:800; opacity:0; animation: float 900ms ease-out forwards }
    @keyframes float{ 0%{transform:translateY(0) scale(.9); opacity:0} 10%{opacity:1} 100%{transform:translateY(-90px) scale(1.1); opacity:0} }

    /* Store */
    aside{display:flex; flex-direction:column; gap:12px}
    .card{background:var(--card); border:1px solid #232436; border-radius:16px; padding:14px; box-shadow: 0 6px 20px rgba(0,0,0,.25)}
    .card h3{margin:0 0 6px; font-size:18px}
    .cost{color:var(--muted); font-weight:600}
    .row{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .btn{display:inline-flex; align-items:center; justify-content:center; gap:8px; cursor:pointer; border:1px solid #2a2b3d;
      background:#171820; color:var(--fg2); padding:10px 12px; border-radius:12px; font-weight:700}
    .btn[disabled]{opacity:.45; cursor:not-allowed}

    .store{display:grid; grid-template-columns:1fr; gap:12px}

    footer{padding:14px 18px; text-align:center; color:#c9c9c9}
    a{color:#ffb44a}

    /* Top-left pumpkin from index */
    #pumpkinHome{position:fixed; top:10px; left:10px; font-size:28px; z-index:50; cursor:pointer}
  </style>
</head>
<body>
  <header>
    <div class="title">üéÉ Happy Helloween!!</div>
    <div class="statbar">
      <div class="chip" aria-live="polite" title="Total candy">
        üç¨ <span id="candy">0</span>
      </div>
      <div class="chip" title="Candy per click">
        üëÜ <span id="cpc">1</span><small>/tap</small>
      </div>
      <div class="chip" title="Candy per second">
        ‚è±Ô∏è <span id="cps">0</span><small>/sec</small>
      </div>
    </div>
  </header>

  <main>
    <section class="play" aria-label="Clicker area">
      <button class="pumpkinBtn" id="pumpkin" aria-label="Click to collect candy">üéÉ</button>
    </section>

    <aside>
      <div class="card">
        <h3>üß™ Power-Ups</h3>
        <div class="store">
          <div class="row">
            <div>
              <div>üç≠ Bigger Bite <small>(+1 candy per click)</small></div>
              <div class="cost">Cost: <span id="cost_click">10</span> üç¨ | Owned: <span id="lvl_click">0</span></div>
            </div>
            <button class="btn" id="buy_click">Buy</button>
          </div>
          <div class="row">
            <div>
              <div>üëª Ghost Helper <small>(+1 candy/sec)</small></div>
              <div class="cost">Cost: <span id="cost_auto">25</span> üç¨ | Owned: <span id="lvl_auto">0</span></div>
            </div>
            <button class="btn" id="buy_auto">Buy</button>
          </div>
          <div class="row">
            <div>
              <div>üïØÔ∏è Creepy Multiplier <small>(√ó1.5 click power)</small></div>
              <div class="cost">Cost: <span id="cost_mult">100</span> üç¨ | Level: <span id="lvl_mult">0</span></div>
            </div>
            <button class="btn" id="buy_mult">Buy</button>
          </div>
        </div>
      </div>

      <div class="card">
        <h3>üé≤ Tricks & Treats</h3>
        <div class="store">
          <div class="row">
            <div>
              <div>ü¶á Bat Frenzy <small>(10s √ó3 candy per click)</small></div>
              <div class="cost">Cost: <span id="cost_frenzy">150</span> üç¨ | Cooldown: <span id="cd_frenzy">ready</span></div>
            </div>
            <button class="btn" id="use_frenzy">Start</button>
          </div>
          <div class="row">
            <div>
              <div>üéÅ Trick‚Äëor‚ÄëTreat <small>(random: win big or lose a bit)</small></div>
              <div class="cost">Cost: <span id="cost_luck">50</span> üç¨</div>
            </div>
            <button class="btn" id="use_luck">Roll</button>
          </div>
        </div>
      </div>

      <div class="card">
        <h3>üíæ Save & Settings</h3>
        <div class="row">
          <button class="btn" id="save">Save</button>
          <button class="btn" id="reset">Reset</button>
        </div>
        <small style="color:#b6b6b6">Saves automatically every 10 seconds.</small>
      </div>
    </aside>
  </main>

  <footer>
    Made with ‚ù§Ô∏è by Calvin ‚Ä¢ Stay spooky.
  </footer>

  <script>
    const el = id => document.getElementById(id);

    // Core state
    const state = {
      candy: 0,
      baseCPC: 1,
      clickUpgrades: 0,
      autoUpgrades: 0,
      multLevel: 0,
      frenzyUntil: 0,
      // shop costs
      costClick: 10,
      costAuto: 25,
      costMult: 100,
      costFrenzy: 150,
      costLuck: 50,
    };

    const UI = {
      candy: el('candy'), cpc: el('cpc'), cps: el('cps'),
      cost_click: el('cost_click'), cost_auto: el('cost_auto'), cost_mult: el('cost_mult'),
      lvl_click: el('lvl_click'), lvl_auto: el('lvl_auto'), lvl_mult: el('lvl_mult'),
      use_frenzy: el('use_frenzy'), cd_frenzy: el('cd_frenzy'),
    };

    function cpc(){
      const mult = Math.pow(1.5, state.multLevel);
      return Math.floor((state.baseCPC + state.clickUpgrades) * mult * (isFrenzy() ? 3 : 1));
    }
    function cps(){ return state.autoUpgrades; }
    function isFrenzy(){ return Date.now() < state.frenzyUntil; }

    // Persistence
    const KEY = 'halloween_clicker_v1';
    function save(){ localStorage.setItem(KEY, JSON.stringify(state)); toast('Saved!'); }
    function load(){
      const raw = localStorage.getItem(KEY);
      if(!raw) return;
      try{ Object.assign(state, JSON.parse(raw)); }catch{}
    }

    // Rendering
    function render(){
      UI.candy.textContent = Math.floor(state.candy);
      UI.cpc.textContent = cpc();
      UI.cps.textContent = cps();
      el('buy_click').disabled = state.candy < state.costClick;
      el('buy_auto').disabled  = state.candy < state.costAuto;
      el('buy_mult').disabled  = state.candy < state.costMult;
      el('use_luck').disabled  = state.candy < state.costLuck;
      UI.use_frenzy.disabled   = state.candy < state.costFrenzy || isFrenzy();

      el('cost_click').textContent = state.costClick;
      el('cost_auto').textContent  = state.costAuto;
      el('cost_mult').textContent  = state.costMult;
      el('cost_frenzy').textContent= state.costFrenzy;
      el('lvl_click').textContent  = state.clickUpgrades;
      el('lvl_auto').textContent   = state.autoUpgrades;
      el('lvl_mult').textContent   = state.multLevel;
      UI.cd_frenzy.textContent     = isFrenzy() ? 'active' : 'ready';
    }

    // Effects
    const playArea = document.querySelector('.play');
    function floatText(txt, x, y){
      const span = document.createElement('span');
      span.className = 'click-plus';
      span.style.left = x + 'px';
      span.style.top  = y + 'px';
      span.textContent = txt;
      playArea.appendChild(span);
      span.addEventListener('animationend', ()=> span.remove());
      // occasional bat emoji
      if(Math.random() < 0.25){
        const bat = document.createElement('span');
        bat.className = 'click-plus';
        bat.style.left = (x + (Math.random()*60-30)) + 'px';
        bat.style.top  = (y + (Math.random()*10-20)) + 'px';
        bat.textContent = 'ü¶á';
        bat.style.animationDuration = (700 + Math.random()*600) + 'ms';
        playArea.appendChild(bat);
        bat.addEventListener('animationend', ()=> bat.remove());
      }
    }

    // Game loop
    let last = performance.now();
    function tick(now){
      const dt = Math.min(0.25, (now - last)/1000); // cap to avoid tab-jump
      last = now;
      state.candy += cps() * dt;
      render();
      requestAnimationFrame(tick);
    }

    // Interaction
    el('pumpkin').addEventListener('click', (e)=>{
      const gain = cpc();
      state.candy += gain;
      const r = playArea.getBoundingClientRect();
      floatText('+'+gain+' üç¨', e.clientX - r.left, e.clientY - r.top);
      render();
    });

    el('buy_click').addEventListener('click', ()=>{
      if(state.candy < state.costClick) return;
      state.candy -= state.costClick; state.clickUpgrades++;
      state.costClick = Math.ceil(state.costClick * 1.25 + 3);
      render();
    });
    el('buy_auto').addEventListener('click', ()=>{
      if(state.candy < state.costAuto) return;
      state.candy -= state.costAuto; state.autoUpgrades++;
      state.costAuto = Math.ceil(state.costAuto * 1.3 + 5);
      render();
    });
    el('buy_mult').addEventListener('click', ()=>{
      if(state.candy < state.costMult) return;
      state.candy -= state.costMult; state.multLevel++;
      state.costMult = Math.ceil(state.costMult * 1.55 + 20);
      render();
    });

    el('use_frenzy').addEventListener('click', ()=>{
      if(state.candy < state.costFrenzy || isFrenzy()) return;
      state.candy -= state.costFrenzy;
      state.frenzyUntil = Date.now() + 10_000; // 10 seconds
      render();
    });

    el('use_luck').addEventListener('click', ()=>{
      if(state.candy < state.costLuck) return;
      state.candy -= state.costLuck;
      // 60% small win, 25% medium win, 10% big win, 5% loss
      const roll = Math.random();
      let delta = 0; let msg = '';
      if(roll < .60){ delta = Math.ceil(state.costLuck * .8); msg = `+${delta} üç¨`; }
      else if(roll < .85){ delta = Math.ceil(state.costLuck * 1.8); msg = `Lucky! +${delta} üç¨`; }
      else if(roll < .95){ delta = Math.ceil(state.costLuck * 4.2); msg = `Jackpot! +${delta} üç¨`; }
      else { delta = -Math.ceil(state.costLuck * .5); msg = `Oops ${delta} üç¨`; }
      state.candy += delta; flash(delta >= 0 ? '#264014' : '#401414');
      floatText(msg, 40 + Math.random()*200, 60 + Math.random()*160);
      render();
    });

    el('save').addEventListener('click', save);
    el('reset').addEventListener('click', ()=>{
      if(confirm('Reset your spooky stash?')){
        localStorage.removeItem(KEY);
        location.reload();
      }
    });

    // feedback helpers
    function toast(text){
      const t = document.createElement('div');
      t.textContent = text; t.style.position='fixed'; t.style.bottom='16px'; t.style.left='50%'; t.style.transform='translateX(-50%)';
      t.style.background='#181a21'; t.style.border='1px solid #2a2b3d'; t.style.padding='8px 12px'; t.style.borderRadius='10px';
      t.style.color='var(--fg2)'; t.style.fontWeight='700'; t.style.zIndex='1000'; t.style.opacity='0';
      t.style.transition='opacity .2s ease, transform .2s ease';
      document.body.appendChild(t);
      requestAnimationFrame(()=>{ t.style.opacity='1'; t.style.transform='translateX(-50%) translateY(-6px)'; });
      setTimeout(()=>{ t.style.opacity='0'; t.style.transform='translateX(-50%)'; t.addEventListener('transitionend', ()=> t.remove(), {once:true}); }, 1200);
    }
    function flash(color){
      const p = document.querySelector('.play');
      const prev = p.style.boxShadow;
      p.style.boxShadow = `0 0 0 9999px ${color}10 inset, 0 0 40px ${color}`;
      setTimeout(()=> p.style.boxShadow = prev, 160);
    }

    // Auto-save
    setInterval(()=>{ localStorage.getItem(KEY) !== JSON.stringify(state) && save(); }, 10_000);

    // Init
    load();
    render();
    requestAnimationFrame(tick);
  </script>
</body>
</html>

